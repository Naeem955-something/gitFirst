<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <title>Write Prescription | MediScript</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link href="../css/output.css" rel="stylesheet" />
  </head>
  <body class="bg-gray-100 font-sans">
    <!-- Sidebar -->
    <aside class="w-64 h-screen bg-white shadow fixed">
      <div
        class="p-6 font-bold text-2xl text-blue-700 border-b border-gray-200"
      >
        <i class="fas fa-notes-medical mr-2"></i> MediScript
      </div>
      <nav class="mt-4 space-y-2 text-gray-700 font-medium px-4">
        <a
          href="dashboard.html"
          class="flex items-center space-x-2 hover:text-blue-600"
        >
          <i class="fas fa-home"></i> <span>Dashboard</span>
        </a>
        <a
          href="doctor_profile.html"
          class="flex items-center space-x-2 hover:text-blue-600"
        >
          <i class="fas fa-user-md"></i> <span>Profile</span>
        </a>
        <a
          href="doctor_patients.html"
          class="flex items-center space-x-2 hover:text-blue-600"
        >
          <i class="fas fa-users"></i> <span>My Patients</span>
        </a>
        <a
          href="doctor_prescribe.html"
          class="flex items-center space-x-2 text-blue-600 font-semibold"
        >
          <i class="fas fa-prescription"></i> <span>Write Prescription</span>
        </a>
        <a
          href="doctor_history.html"
          class="flex items-center space-x-2 hover:text-blue-600"
        >
          <i class="fas fa-file-medical-alt"></i>
          <span>Past Prescriptions</span>
        </a>
        <a
          href="doctor_report.html"
          class="flex items-center space-x-2 hover:text-blue-600"
        >
          <i class="fas fa-flag"></i> <span>Report Issue</span>
        </a>
        <a
          href="#"
          onclick="logout()"
          class="flex items-center space-x-2 text-red-600 hover:text-red-800 mt-10"
        >
          <i class="fas fa-sign-out-alt"></i> <span>Logout</span>
        </a>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="ml-64 p-8">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold text-blue-700">
          <i class="fas fa-prescription mr-2"></i> Write Prescription
        </h1>
        <button
          onclick="window.history.back()"
          class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded"
        >
          <i class="fas fa-arrow-left mr-1"></i> Back
        </button>
      </div>

      <form id="prescriptionForm" class="space-y-6">
        <!-- Section 1: Patient Info (Read-Only) -->
        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-lg font-semibold text-blue-700 mb-4">
            üë§ Patient Information
          </h2>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700"
                >Patient Name</label
              >
              <input
                type="text"
                id="patientName"
                readonly
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700"
                >Patient ID</label
              >
              <input
                type="text"
                id="patientId"
                readonly
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Age</label>
              <input
                type="text"
                id="patientAge"
                readonly
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700"
                >Gender</label
              >
              <input
                type="text"
                id="patientGender"
                readonly
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700"
                >Phone</label
              >
              <input
                type="text"
                id="patientPhone"
                readonly
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"
              />
            </div>
          </div>
        </div>

        <!-- Section 2: Diagnosis & Symptoms -->
        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-lg font-semibold text-blue-700 mb-4">
            üîç Diagnosis & Symptoms
          </h2>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Symptoms</label
              >
              <textarea
                name="symptoms"
                rows="3"
                class="block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                placeholder="Describe the patient's symptoms..."
              ></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Diagnosis</label
              >
              <textarea
                name="diagnosis"
                rows="3"
                class="block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                placeholder="Enter your diagnosis..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Section 3: Suggested Tests -->
        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-lg font-semibold text-blue-700 mb-4">
            üß™ Suggested Tests
          </h2>
          <div id="testsContainer" class="space-y-3">
            <!-- Tests will be added here dynamically -->
          </div>
          <button
            type="button"
            onclick="addTest()"
            class="mt-3 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded"
          >
            ‚ûï Add Test
          </button>
        </div>

        <!-- Section 4: Add Medicines -->
        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-lg font-semibold text-blue-700 mb-4">üíä Medicines</h2>
          <div id="medicinesContainer" class="space-y-4">
            <!-- Medicines will be added here dynamically -->
          </div>
          <button
            type="button"
            onclick="addMedicine()"
            class="mt-3 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded"
          >
            ‚ûï Add Medicine
          </button>
        </div>

        <!-- Section 5: Submit -->
        <div class="bg-white rounded-lg shadow p-6">
          <div class="flex justify-end space-x-4">
            <button
              type="button"
              onclick="window.history.back()"
              class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded font-semibold"
            >
              üîµ Submit Prescription
            </button>
          </div>
        </div>
      </form>
    </main>

    <!-- Prescription Preview Modal -->
    <div
      id="previewModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50"
    >
      <div
        class="bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto"
      >
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-blue-700">
              Prescription Preview
            </h2>
            <button
              onclick="closePreviewModal()"
              class="text-gray-500 hover:text-gray-700"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          <div id="prescriptionPreview" class="border p-6 bg-gray-50">
            <!-- Prescription content will be rendered here -->
          </div>
          <div class="flex justify-end space-x-4 mt-6">
            <button
              onclick="closePreviewModal()"
              class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded"
            >
              Cancel
            </button>
            <button
              onclick="confirmPrescription()"
              class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded"
            >
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/doctor_add_prescription.js"></script>
    <script>
      function logout() {
        fetch("/auth/logout", { method: "POST" })
          .then(() => (window.location.href = "/"))
          .catch(() => alert("Logout failed."));
      }
    </script>
  </body>
</html>
